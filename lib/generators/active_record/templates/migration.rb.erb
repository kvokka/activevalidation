# frozen_string_literal: true

class Create<%= name.camelize %> < ActiveRecord::Migration[<%= ActiveRecord::Migration.current_version %>]
  def change
    create_table :active_validation_manifests, id: :<%= primary_key_type %> do |t|
      t.string   :name
      t.string   :version, index: true
      t.string   :model_klass, index: true

      t.datetime :created_at, null: false
    end

    add_index :active_validation_manifests, %i[model_klass version],
              name: "index_active_validation_manifest_on_model_klass_version"

    create_table :active_validation_checks, id: :<%= primary_key_type %> do |t|
      t.references :manifest, type: :<%= primary_key_type %>
      t.string     :type
      t.string     :argument

      t.json       :options

      t.datetime :created_at, null: false
    end
  end
end
